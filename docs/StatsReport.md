# Отчёт stats — статистика балансов или полупроводок по счетам

## Описание

Отчёт выводит статистические данные по счету или группе счетов.

В качестве исходных данных для каждого счёта могут использоваться:
  
* история (доступных или финансовых) балансов счёта
* история полупроводок по счёту

По выбранным данным отчёт выводит:

* Первое значение.
* Минимальное значение.
* Первую квантиль.
* Медиану (вторую квантиль).
* Третью квантиль.
* Максимальное значение.
* Среднее значение.
* Среднеквадратичное отклонение.
* Последнее значение.

Для групп счетов берутся исторические данные по всем счетам, входящим в группу.

## Параметры

Один необязательный параметр — путь к счёту или группе счетов, по которым считать обороты. Если не указан, отчёт строится по всем счетам.

Если отчёт строится по одному счёту по периодам, то на каждый период выводится отдельная строка (см. пример ниже).

Опции:

-   `-z`, `--no-zeros` — не показывать нулевые строки (например, для счетов, по которым в данный период не было проводок).
-   `-g`, `--hide-groups` — при выводе отчёта по группе счетов в CSV не выводить строки для групп счетов, выводить только данные по отдельным счетам.
-   `--no-currencies` — не выводить символ валюты (работает только для отчёта по одному счёту, для отчёта по группе счетов валюты не отображаются никогда).
-   `-A`, `--amounts` — использовать в качестве исторических данных суммы полупроводок по счетам. Если не указано — используются суммы балансов.
-   `-l`, `--ledger` — использовать суммы финансовых балансов. По умолчанию используются суммы доступных балансов. Работает только если не указан флаг `-A`.
-   `-i`, `--internal=GROUP` — отображать только данные по проводкам, сделанным в рамках указанной группы счетов. Если значение параметра не указано, то оно считается равным счёту (группе), по которому строится отчёт.
-   `-C`, `--csv` — выводить данные в виде CSV.

## Примеры вызова

Статистика по всем счетам:

    $ yaledger stats
    From the begining till 2013/03/29, 22:09:28
    ╒═════════════════════════════════════╤════════════╤════════════╤════════════╤════════════╤════════════╤════════════╤════════════╤═══════════╤════════════╕
    │               ACCOUNT               │    OPEN    │    MIN     │     Q1     │   MEDIAN   │     Q3     │    MAX     │    AVG     │    SD     │   CLOSE    │
    ╞═════════════════════════════════════╪════════════╪════════════╪════════════╪════════════╪════════════╪════════════╪════════════╪═══════════╪════════════╡
    │ ╰—□ Root:                           │     4.4200 │ -6400.0000 │    -6.5000 │    15.0000 │    85.0000 │  6400.0000 │   431.9876 │ 1880.9473 │  6284.5000 │
    │   ├—□ сверка:                       │  -100.0000 │  -100.0000 │  -100.0000 │  -100.0000 │  -100.0000 │  -100.0000 │  -100.0000 │    0.0000 │  -100.0000 │
    │   ├—□ roubles:                      │   100.0000 │   100.0000 │   100.0000 │   101.0000 │   102.0000 │   102.0000 │   101.3333 │    1.1547 │   102.0000 │
    │   ├—□ dollars:                      │   -19.1200 │  -119.1200 │   -94.1200 │   -51.1200 │   -44.1200 │   -19.1200 │   -57.7867 │   34.2150 │   -51.1200 │
    │   ├—□ difference:                   │     4.4200 │     4.4200 │     4.4200 │     4.5900 │     4.7000 │     6.9400 │     5.1625 │    1.1906 │     6.9400 │
    │   ├—□ X:                            │    81.0000 │     2.4000 │    41.7050 │    97.2000 │   117.8000 │   175.8000 │    96.4210 │   59.2896 │   175.8000 │
    │   │ ├—□ X1:                         │    81.0000 │    81.0000 │    97.2000 │    98.8000 │   133.8000 │   175.8000 │   119.9250 │   36.9166 │   175.8000 │
    │   │ ╰—□ X2:                         │     2.4000 │     2.4000 │     2.4000 │     2.4000 │     2.4050 │     2.4100 │     2.4050 │    0.0071 │     2.4100 │
    │   ├—□ Y:                            │  -100.0000 │  -161.5000 │  -159.6250 │  -153.5000 │   -27.2500 │    -2.0000 │   -99.4444 │   74.9773 │    -3.0000 │
    │   │ ├—□ Y1:                         │  -100.0000 │  -161.5000 │  -160.7500 │  -158.5000 │  -153.5000 │  -100.0000 │  -147.8333 │   23.7711 │  -161.5000 │
    │   │ ├—□ Y2:                         │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    0.0000 │    -3.0000 │
    │   │ ├—□ Y3:                         │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    -3.0000 │    0.0000 │    -3.0000 │
    │   │ ╰—□ Y4:                         │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    0.0000 │    -2.0000 │
    │   ├—□ Z:                            │    50.0000 │   -57.0000 │     0.0000 │    10.0000 │    57.0000 │   100.0000 │    24.9994 │   39.0751 │   -57.0000 │
    │   │ ├—□ Y4:                         │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │   │ ├—□ Z1:                         │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │   │ ├—□ Z2:                         │    50.0000 │    50.0000 │    51.7500 │    57.7500 │    59.6250 │    61.5000 │    57.4000 │    4.4637 │    61.5000 │
    │   │ ├—□ Z3:                         │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │   │ ├—□ Z4:                         │    -0.0100 │    -0.0100 │    -0.0100 │    -0.0100 │    -0.0100 │    -0.0100 │    -0.0100 │    0.0000 │    -0.0100 │
    │   │ ├—□ Z5:                         │   100.0000 │     0.0000 │     0.0000 │    10.0000 │    42.5000 │   100.0000 │    34.0000 │   42.1900 │     0.0000 │
    │   │ ├—□ Z6:                         │    10.0000 │     0.0000 │     0.0000 │     0.0000 │     2.5000 │    10.0000 │     3.3333 │    5.7735 │     0.0000 │
    │   │ ╰—□ Z7:                         │   -10.0000 │   -57.0000 │   -57.0000 │   -57.0000 │   -33.5000 │   -10.0000 │   -33.5000 │   33.2340 │   -57.0000 │
    │   ├—□ активы:                       │   -15.0000 │   -15.0000 │    35.0000 │    85.0000 │  6284.5000 │  6400.0000 │  3011.9167 │ 3118.8489 │  6284.5000 │
    │   │ ├—□ карточка:                   │  6400.0000 │  5284.5000 │  5292.0000 │  6284.5000 │  6299.7500 │  6400.0000 │  5978.0000 │  532.9872 │  6284.5000 │
    │   │ ├—□ карман:                     │   -15.0000 │   -15.0000 │     7.5000 │    35.0000 │    70.0000 │    85.0000 │    45.8333 │   38.0022 │    30.0000 │
    │   │ ╰—□ кошелёк:                    │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │   ╰—□ движение:                     │    15.0000 │ -6400.0000 │    -1.3750 │    15.0000 │    15.3750 │    45.0000 │  -694.5556 │ 2139.6058 │    15.5000 │
    │     ├—□ расходы:                    │    15.0000 │     0.5000 │    11.3750 │    15.0000 │    22.8750 │    45.0000 │    21.5714 │   16.8731 │    15.5000 │
    │     │ ├—□ трамвай:                  │    15.0000 │    15.0000 │    15.0000 │    15.0000 │    37.5000 │    45.0000 │    27.0000 │   16.4317 │    45.0000 │
    │     │ ├—□ интернет:                 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │     │ ├—□ банковское_обслуживание:  │     0.5000 │     0.5000 │     0.5000 │     0.5000 │     8.0000 │    15.5000 │     8.0000 │   10.6066 │    15.5000 │
    │     │ ╰—□ чай:                      │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │     ╰—□ доходы:                     │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -3201.0000 │    -2.0000 │ -3201.0000 │ 4524.0692 │    -2.0000 │
    │       ├—□ зарплата:                 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │    0.0000 │ -6400.0000 │
    │       ├—□ премия:                   │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │       ├—□ аванс:                    │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │     0.0000 │    0.0000 │     0.0000 │
    │       ╰—□ разное:                   │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    0.0000 │    -2.0000 │
    ╘═════════════════════════════════════╧════════════╧════════════╧════════════╧════════════╧════════════╧════════════╧════════════╧═══════════╧════════════╛

Статистика по полупроводкам одной группы счетов:

    $ yaledger stats -z -A доходы
    From the begining till 2013/03/29, 22:10:50
    ╒══════════════════╤════════════╤════════════╤════════════╤════════════╤════════════╤════════════╤════════════╤═══════════╤════════════╕
    │     ACCOUNT      │    OPEN    │    MIN     │     Q1     │   MEDIAN   │     Q3     │    MAX     │    AVG     │    SD     │   CLOSE    │
    ╞══════════════════╪════════════╪════════════╪════════════╪════════════╪════════════╪════════════╪════════════╪═══════════╪════════════╡
    │ ╰—□ доходы:      │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -3201.0000 │    -2.0000 │ -3201.0000 │ 4524.0692 │    -2.0000 │
    │   ├—□ зарплата:  │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │ -6400.0000 │    0.0000 │ -6400.0000 │
    │   ╰—□ разное:    │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    -2.0000 │    0.0000 │    -2.0000 │
    ╘══════════════════╧════════════╧════════════╧════════════╧════════════╧════════════╧════════════╧════════════╧═══════════╧════════════╛

Статистика по одному счёту по периодам:

    $ yaledger --monthly stats карточка
    ╒════════════╤══════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤═════════╤══════════╕
    │    FROM    │          TO          │   OPEN   │   MIN    │    Q1    │  MEDIAN  │    Q3    │   MAX    │   AVG    │   SD    │  CLOSE   │
    ╞════════════╪══════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪═════════╪══════════╡
    │ 2012/09/01 │ 2012/09/28           │ 6400.00р │ 6299.50р │ 6299.50р │ 6299.75р │ 6325.00р │ 6400.00р │ 6333.17р │  57.88р │ 6299.50р │
    │ 2012/09/28 │ 2012/10/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │   0.00р │    0.00р │
    │ 2012/10/28 │ 2012/11/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │   0.00р │    0.00р │
    │ 2012/11/28 │ 2012/12/28           │ 5299.50р │ 5284.50р │ 5284.50р │ 5292.00р │ 5545.75р │ 6284.50р │ 5622.83р │ 573.07р │ 6284.50р │
    │ 2012/12/28 │ 2013/01/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │   0.00р │    0.00р │
    │ 2013/01/28 │ 2013/02/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │   0.00р │    0.00р │
    │ 2013/02/28 │ 2013/03/29, 22:11:33 │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │   0.00р │    0.00р │
    ╘════════════╧══════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧═════════╧══════════╛

Статистика по движению средств в пределах одной группы:

    $ yaledger --montly stats --internal=движение карточка
    ╒════════════╤══════════════════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤══════════╤════════╤══════════╕
    │    FROM    │          TO          │   OPEN   │   MIN    │    Q1    │  MEDIAN  │    Q3    │   MAX    │   AVG    │   SD   │  CLOSE   │
    ╞════════════╪══════════════════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪══════════╪════════╪══════════╡
    │ 2012/09/01 │ 2012/09/28           │ 6400.00р │ 6299.50р │ 6299.50р │ 6299.50р │ 6349.75р │ 6400.00р │ 6349.75р │ 71.06р │ 6299.50р │
    │ 2012/09/28 │ 2012/10/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │  0.00р │    0.00р │
    │ 2012/10/28 │ 2012/11/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │  0.00р │    0.00р │
    │ 2012/11/28 │ 2012/12/28           │ 5284.50р │ 5284.50р │ 5284.50р │ 5284.50р │ 5284.50р │ 5284.50р │ 5284.50р │  0.00р │ 5284.50р │
    │ 2012/12/28 │ 2013/01/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │  0.00р │    0.00р │
    │ 2013/01/28 │ 2013/02/28           │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │  0.00р │    0.00р │
    │ 2013/02/28 │ 2013/03/29, 22:14:50 │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │    0.00р │  0.00р │    0.00р │
    ╘════════════╧══════════════════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧══════════╧════════╧══════════╛

